(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4790:function(e,t,n){Promise.resolve().then(n.bind(n,8212))},8212:function(e,t,n){"use strict";n.r(t);var a=n(7437),s=n(2265),o=n(7818),c=n(2800);n(1918);let r=(0,o.default)(()=>Promise.all([n.e(967),n.e(825),n.e(899)]).then(n.bind(n,6899)),{loadableGenerated:{webpack:()=>[6899]},ssr:!1}),l=(0,o.default)(()=>Promise.all([n.e(401),n.e(967),n.e(118),n.e(392)]).then(n.bind(n,8392)),{loadableGenerated:{webpack:()=>[8392]},ssr:!1}),i=(0,o.default)(()=>n.e(439).then(n.bind(n,2439)),{loadableGenerated:{webpack:()=>[2439]},ssr:!1});t.default=()=>{let[e,t]=(0,s.useState)(null),[n,o]=(0,s.useState)(!0),[d,u]=(0,s.useState)(25),p=e=>{if("object"==typeof e&&null!==e)return e;try{let t=JSON.parse(e);if("object"==typeof t&&null!==t)return t}catch(e){console.error("Invalid JSON string provided, using empty object as fallback.",e)}return{}},f=(0,s.useCallback)(e=>{console.log("Received SSE message:",e),t(t=>{if(!t)return null;let n={...t};return"chat_history"===e.type?n.chat_history=e.chat_history:"plan"===e.type?n.current_plan=p(e.plan):"code"===e.type&&(n.step_codes=e.step_codes),console.log("Updated session data:",n),n})},[]);(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,c.Gg)();console.log("Fetched session data:",e),t(e);let n=(0,c._I)(e.session_id);return n.onmessage=e=>{let t=JSON.parse(e.data);f(t)},n.onerror=e=>{console.error("EventSource failed:",e),n.close()},()=>{n.close()}}catch(e){console.error("Failed to fetch session data:",e)}finally{o(!1)}})()},[f]);let h=(0,s.useCallback)(async n=>{if(e){console.log("Updating plan with:",n);try{await (0,c.F9)(e.session_id,n),t(e=>{let t={...e,current_plan:n};return console.log("Updated session data after plan update:",t),t})}catch(e){console.error("Failed to update plan:",e)}}},[e]),_=(0,s.useCallback)(async(n,a)=>{if(e){console.log("Updating code for step ".concat(n,":"),a);try{let s={...e.step_codes,[n]:a};await (0,c.IX)(s),t(e=>{let t={...e,step_codes:s};return console.log("Updated session data after code update:",t),t})}catch(e){console.error("Failed to update code:",e)}}},[e]);return n?(0,a.jsx)("div",{className:"flex justify-center items-center h-screen bg-background text-foreground",children:"Loading..."}):e?(console.log("Rendering Home component with session data:",e),(0,a.jsxs)("div",{className:"flex h-screen w-full bg-background text-foreground overflow-hidden",children:[(0,a.jsx)("div",{style:{width:"".concat(d,"%")},className:"h-full overflow-hidden",children:(0,a.jsx)(r,{initialMessages:e.chat_history,currentPlan:e.current_plan})}),(0,a.jsx)(i,{onResize:e=>{u(e)}}),(0,a.jsx)("div",{style:{width:"".concat(100-d,"%")},className:"h-full overflow-hidden",children:(0,a.jsx)(l,{currentPlan:e.current_plan,stepCodes:e.step_codes,onPlanUpdate:h,onCodeUpdate:_})})]})):(0,a.jsx)("div",{className:"flex justify-center items-center h-screen bg-background text-foreground",children:"No session data available."})}},2800:function(e,t,n){"use strict";n.d(t,{F9:function(){return _},Gg:function(){return u},IX:function(){return g},MQ:function(){return d},_I:function(){return h},bE:function(){return p},cE:function(){return f},ef:function(){return y}});var a=n(8472),s=n(2649);let o="/api",c="session_id",r=e=>{s.Z.set(c,e,{expires:7})},l=()=>s.Z.get(c)||"",i=async()=>{let e=await a.Z.post("".concat(o,"/sessions"));return r(e.data.session_id),e.data},d=async()=>{let e=l();return e||r(e=(await i()).session_id),e},u=async()=>{let e=await d();return(await a.Z.get("".concat(o,"/sessions/").concat(e))).data},p=async e=>{let t=await d();return(await a.Z.post("".concat(o,"/schat"),{session_id:t,message:e})).data.session_id},f=e=>new EventSource("".concat(o,"/chat-stream?session_id=").concat(e)),h=e=>new EventSource("".concat(o,"/sse?session_id=").concat(e)),_=async(e,t)=>(await a.Z.put("".concat(o,"/sessions/").concat(e,"/current_plan"),t,{headers:{"Content-Type":"application/json"}})).data,g=async e=>{let t=await d();return(await a.Z.put("".concat(o,"/sessions/").concat(t,"/step_codes"),e)).data},y=async e=>{let t=await d();return(await a.Z.post("".concat(o,"/save_plan"),{session_id:t,plan:e})).data}},1918:function(){}},function(e){e.O(0,[725,135,971,23,744],function(){return e(e.s=4790)}),_N_E=e.O()}]);