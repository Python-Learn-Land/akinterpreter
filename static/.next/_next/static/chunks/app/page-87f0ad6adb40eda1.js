(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4790:function(e,t,a){Promise.resolve().then(a.bind(a,6072))},6072:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return g}});var n=a(7437),s=a(2265),r=a(7818),o=a(2800);a(1918);var c=a(1322),i=a(1505),l=a(9354);let d=e=>{let{className:t,...a}=e;return(0,n.jsx)(i.eh,{className:(0,l.cn)("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",t),...a})},u=i.s_,f=e=>{let{withHandle:t,className:a,...s}=e;return(0,n.jsx)(i.OT,{className:(0,l.cn)("relative flex w-px items-center justify-center bg-slate-200 after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-950 focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90 dark:bg-slate-800 dark:focus-visible:ring-slate-300",a),...s,children:t&&(0,n.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border border-slate-200 bg-slate-200 dark:border-slate-800 dark:bg-slate-800",children:(0,n.jsx)(c.Z,{className:"h-2.5 w-2.5"})})})},p=(0,r.default)(()=>Promise.all([a.e(231),a.e(899)]).then(a.bind(a,6899)),{loadableGenerated:{webpack:()=>[6899]},ssr:!1}),h=(0,r.default)(()=>Promise.all([a.e(401),a.e(118),a.e(392)]).then(a.bind(a,8392)),{loadableGenerated:{webpack:()=>[8392]},ssr:!1});var g=()=>{let[e,t]=(0,s.useState)(null),[a,r]=(0,s.useState)(!0),[c,i]=(0,s.useState)(25),l=e=>{if("object"==typeof e&&null!==e)return e;try{let t=JSON.parse(e);if("object"==typeof t&&null!==t)return t}catch(e){console.error("Invalid JSON string provided, using empty object as fallback.",e)}return{}},g=(0,s.useCallback)(e=>{console.log("Received SSE message:",e),t(t=>{if(!t)return null;let a={...t};return"chat_history"===e.type?a.chat_history=e.chat_history:"plan"===e.type?a.current_plan=l(e.plan):"code"===e.type&&(a.step_codes=e.step_codes),console.log("Updated session data:",a),a})},[]);(0,s.useEffect)(()=>{(async()=>{try{let e=await (0,o.Gg)();console.log("Fetched session data:",e),t(e);let a=(0,o._I)(e.session_id);return a.onmessage=e=>{let t=JSON.parse(e.data);g(t)},a.onerror=e=>{console.error("EventSource failed:",e),a.close()},()=>{a.close()}}catch(e){console.error("Failed to fetch session data:",e)}finally{r(!1)}})()},[g]);let v=(0,s.useCallback)(async a=>{if(e){console.log("Updating plan with:",a);try{await (0,o.F9)(e.session_id,a),t(e=>{let t={...e,current_plan:a};return console.log("Updated session data after plan update:",t),t})}catch(e){console.error("Failed to update plan:",e)}}},[e]),b=(0,s.useCallback)(async(a,n)=>{if(e){console.log("Updating code for step ".concat(a,":"),n);try{let s={...e.step_codes,[a]:n};await (0,o.IX)(s),t(e=>{let t={...e,step_codes:s};return console.log("Updated session data after code update:",t),t})}catch(e){console.error("Failed to update code:",e)}}},[e]);return a?(0,n.jsx)("div",{className:"flex justify-center items-center h-screen bg-background text-foreground",children:"Loading..."}):e?(console.log("Rendering Home component with session data:",e),(0,n.jsxs)(d,{direction:"horizontal",className:"h-screen w-full bg-background text-foreground overflow-hidden",children:[(0,n.jsx)(u,{defaultSize:25,minSize:20,children:(0,n.jsx)("div",{className:"h-full overflow-hidden",children:(0,n.jsx)(p,{initialMessages:e.chat_history,currentPlan:e.current_plan})})}),(0,n.jsx)(f,{}),(0,n.jsx)(u,{defaultSize:75,minSize:30,children:(0,n.jsx)("div",{className:"h-full overflow-hidden",children:(0,n.jsx)(h,{currentPlan:e.current_plan,stepCodes:e.step_codes,onPlanUpdate:v,onCodeUpdate:b})})})]})):(0,n.jsx)("div",{className:"flex justify-center items-center h-screen bg-background text-foreground",children:"No session data available."})}},2800:function(e,t,a){"use strict";a.d(t,{F9:function(){return g},Gg:function(){return u},IX:function(){return v},MQ:function(){return d},_I:function(){return h},bE:function(){return f},cE:function(){return p},ef:function(){return b}});var n=a(8472),s=a(2649);let r="/api",o="session_id",c=e=>{s.Z.set(o,e,{expires:7})},i=()=>s.Z.get(o)||"",l=async()=>{let e=await n.Z.post("".concat(r,"/sessions"));return c(e.data.session_id),e.data},d=async()=>{let e=i();return e||c(e=(await l()).session_id),e},u=async()=>{let e=await d();return(await n.Z.get("".concat(r,"/sessions/").concat(e))).data},f=async e=>{let t=await d();return(await n.Z.post("".concat(r,"/schat"),{session_id:t,message:e})).data.session_id},p=e=>new EventSource("".concat(r,"/chat-stream?session_id=").concat(e)),h=e=>new EventSource("".concat(r,"/sse?session_id=").concat(e)),g=async(e,t)=>(await n.Z.put("".concat(r,"/sessions/").concat(e,"/current_plan"),t,{headers:{"Content-Type":"application/json"}})).data,v=async e=>{let t=await d();return(await n.Z.put("".concat(r,"/sessions/").concat(t,"/step_codes"),e)).data},b=async e=>{let t=await d();return(await n.Z.post("".concat(r,"/save_plan"),{session_id:t,plan:e})).data}},9354:function(e,t,a){"use strict";a.d(t,{cn:function(){return r}});var n=a(4839),s=a(6164);function r(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,s.m6)((0,n.W)(t))}},1918:function(){}},function(e){e.O(0,[725,537,843,971,23,744],function(){return e(e.s=4790)}),_N_E=e.O()}]);