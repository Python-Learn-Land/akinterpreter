"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{9913:function(e,t,l){l.r(t),l.d(t,{default:function(){return o}});var r=l(7437),s=l(2265),a=l(6648),n=l(6913),i=l(1003),c=e=>{let{type:t,content:l,isBot:s}=e;return(0,r.jsx)("div",{className:"max-w-3/4 ".concat(s?"ml-0 mr-auto":"ml-auto mr-0"),children:(0,r.jsx)("div",{className:"p-3 rounded-lg ".concat(s?"bg-gray-700 text-white":"bg-blue-500 text-white"," max-h-[80vh] overflow-y-auto"),children:(()=>{if("object"==typeof l)return(0,r.jsx)(n.Z,{language:"json",style:i.Z,children:JSON.stringify(l,null,2)});if("string"==typeof l){let e=l.replace(/^```(json|python)?\s*|\s*```$/g,"");try{let t=JSON.parse(e);return(0,r.jsx)(n.Z,{language:"json",style:i.Z,children:JSON.stringify(t,null,2)})}catch(e){}return e.includes("def ")||e.includes("import ")||e.includes("print(")?(0,r.jsx)(n.Z,{language:"python",style:i.Z,children:e}):e.split(/(\!\[.*?\]\(.*?\)|\[.*?\]\(.*?\))/).map((e,t)=>{if(e.startsWith("![")){let l=e.match(/\!\[(.*?)\]\((.*?)\)/);if(l)return(0,r.jsx)("div",{className:"relative w-full h-64 my-2",children:(0,r.jsx)(a.default,{src:l[2],alt:l[1],layout:"fill",objectFit:"contain"})},t)}else if(e.startsWith("[")){let l=e.match(/\[(.*?)\]\((.*?)\)/);if(l)return(0,r.jsx)("a",{href:l[2],target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 hover:underline",children:l[1]},t)}return(0,r.jsx)("span",{children:e},t)})}return(0,r.jsx)("p",{className:"break-words whitespace-pre-wrap",children:String(l)})})()})})},u=l(2800),o=e=>{let{initialMessages:t}=e,[l,a]=(0,s.useState)(t),[n,i]=(0,s.useState)(""),[o,d]=(0,s.useState)(!1),[h,f]=(0,s.useState)(null);(0,s.useRef)(null);let x=(0,s.useRef)(null);(0,s.useRef)(null);let p=(0,s.useRef)(null);(0,s.useEffect)(()=>{(async()=>{f(await (0,u.MQ)())})()},[]);let g=(0,s.useCallback)(async e=>{e.trim()&&!o&&(a(t=>[...t,{type:"text",content:e,isBot:!1}]),i(""),d(!0),d(!1))},[o]);return(0,r.jsxs)("div",{className:"flex flex-col h-full bg-gray-900 text-white",children:[(0,r.jsxs)("div",{className:"flex-grow overflow-y-auto p-4 space-y-4",children:[l.map((e,t)=>(0,r.jsx)(c,{type:e.type,content:e.content,isBot:e.isBot},t)),o&&(0,r.jsx)("p",{className:"italic text-gray-500",children:"\uD83E\uDD16在努力思考。。。"}),(0,r.jsx)("div",{ref:x})]}),(0,r.jsx)("div",{className:"flex-shrink-0 border-t border-gray-700 p-2",children:(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("textarea",{ref:p,value:n,onChange:e=>i(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),g(n))},className:"flex-grow p-2 bg-gray-800 border border-gray-700 rounded-l-md resize-none",placeholder:"输入消息... (Shift+Enter 换行)",disabled:o,rows:1,style:{minHeight:"38px",maxHeight:"38px",overflow:"auto"}}),(0,r.jsx)("button",{onClick:()=>g(n),className:"p-2 bg-blue-600 text-white rounded-r-md h-[38px]",disabled:o,children:"发送"})]})})]})}}}]);